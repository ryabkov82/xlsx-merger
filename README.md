# xlsx-merger

`xlsx-merger` — это утилита на Go для объединения множества Excel-файлов (`.xlsx`) в один или несколько выходных файлов с сохранением:

* стилей ячеек (шрифтов, форматов чисел, выравнивания и т.д.)
* ширины колонок и высоты строк
* правильных типов данных (числа, строки, булевы и даты)
* автоматического определения форматов чисел

Поддерживается разбиение результата на несколько файлов, если число строк превышает заданное ограничение (`--max-row`).

---

## Особенности

* Использует `excelize.StreamWriter` для работы с большими XLSX
* Поддержка нескольких выходных файлов при превышении `--max-row`
* Сохранение форматирования из шаблона (самого большого исходного файла)
* Автоматическое определение и сохранение форматов чисел с нужным числом знаков после запятой
* Поддержка добавления имени исходного файла в конец строки

---

## Установка и сборка

### Требуется: Go 1.19+

```bash
go build -o xlsx-merger main.go
```

### Просмотр справки:

```bash
./xlsx-merger --help
```

---

## Использование из Go

```go
err := sm.MergeFiles(&config.Config{
    InputDir:       "./input",
    OutputPath:     "./output/merged.xlsx",
    MaxRowPerFile:  600000,
    HasHeaders:     true,
    AddSourceFile:  true,
})
```

---

## Использование из командной строки

```bash
./xlsx-merger \
  --dir ./testdata \
  --out ./merged/output.xlsx \
  --sample 50 \
  --add-source=true \
  --has-headers=true \
  --max-row 600000
```

---

## Параметры командной строки

| Ключ            | Описание                                          |
| --------------- | ------------------------------------------------- |
| `--dir`         | Папка с исходными `.xlsx` файлами                 |
| `--out`         | Базовое имя выходного файла                       |
| `--sample`      | Число строк для анализа стилей                    |
| `--add-source`  | Добавлять имя исходного файла в последний столбец |
| `--has-headers` | Заголовки присутствуют в исходных файлах          |
| `--buffer`      | Размер буфера (строк между сохранениями)          |
| `--max-row`     | Макс. число строк в одном выходном файле          |


---

## Требования

* Go 1.19+
* [github.com/xuri/excelize/v2](https://github.com/xuri/excelize)

---

## Лицензия

MIT
