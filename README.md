# StreamMerger

`StreamMerger` — это утилита на Go для объединения множества Excel-файлов (`.xlsx`) в один или несколько выходных файлов с сохранением:

* стилей ячеек (шрифтов, форматов чисел, выравнивания и т.д.)
* ширины колонок и высоты строк
* правильных типов данных (числа, строки, булевы и даты)

Поддерживается разбиение результата на несколько файлов, если число строк превышает заданное ограничение.

## Особенности

* Использует `excelize.StreamWriter` для работы с большими XLSX
* Поддержка нескольких выходных файлов при превышении `MaxRowPerFile`
* Автоматическое определение и сохранение форматов чисел с нужным кол-вом знаков после запятой
* Сохранение форматирования из шаблона (самого большого исходного файла)

## Установка

```bash
go get github.com/ryabkov82/xlsx-merger
```

## Использование из Go

```go
err := sm.MergeFiles(&config.Config{
    InputDir:       "./input",
    OutputPath:     "./output/merged.xlsx",
    MaxRowPerFile:  600000,
    HasHeaders:     true,
    AddSourceFile:  true,
})
```

## Использование из командной строки

```bash
go run main.go \
  -dir ./testdata \
  -out ./merged/output.xlsx \
  -sample 50 \
  -add-source=true \
  -has-headers=true \
  -max-row 600000
```

## Параметры конфигурации

| Ключ           | Описание                                          |
| -------------- | ------------------------------------------------- |
| `-dir`         | Папка с исходными `.xlsx` файлами                 |
| `-out`         | Базовое имя выходного файла                       |
| `-sample`      | Число строк для анализа стилей                    |
| `-add-source`  | Добавлять имя исходного файла в последний столбец |
| `-has-headers` | Заголовки присутствуют в исходных файлах          |
| `-max-row`     | Макс. число строк в одном выходном файле          |

## Требования

* Go 1.18+
* [github.com/xuri/excelize/v2](https://github.com/xuri/excelize)

## Лицензия

MIT
